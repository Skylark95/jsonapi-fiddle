class Jsonapi{constructor(t){this.options=t,this.options.headers=t.headers||{},this.options.headers=Object.assign(this.options.headers,{"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json, application/json, */*"}),this.results=document.querySelectorAll("[data-jsonapi-results]"),0===this.results.length&&(this.results=document.createElement("div"),this.results.setAttribute("data-jsonapi-results",""),document.querySelector("body").appendChild(this.results))}_addResult(t,e,s,a,i){let n=document.createElement("div"),r=-1===i.indexOf(a.data.id)?`${i}/${a.data.id}`:i
n.setAttribute("data-jsonapi-result",""),n.innerText=`${t} - ${e} ${s}: `
let o=document.createElement("a")
o.setAttribute("href",r),o.setAttribute("target","_blank"),o.innerText=r,n.appendChild(o),console.log(`${n.innerText}`),console.log(a),this.results.appendChild(n)}ajax(t,e,s){let a=this,i=this.options,n={data:s.data},r=`${i.baseURL}/${e}`
return new Promise((e,s)=>{$.ajax({url:r,method:t,dataType:"json",crossDomain:!0,headers:i.headers,xhrFields:{withCredentials:i.withCredentials},data:JSON.stringify(n),success:function(s,i,n){let o=n.status,d=n.statusText
a._addResult(t,o,d,s,r),e(new JsonapiDocument(s.data))},error:function(t){console.error(`${t.status} ${t.statusText}: ${r}`),console.error(t),s(t)}})})}get(t,e){return this.ajax("GET",`${t}/${e}`)}post(t){return this.ajax("POST",t.data.type,t)}patch(t){return this.ajax("PATCH",`${t.data.type}/${t.data.id}`,t)}createDocument(t){return new JsonapiDocument(t)}}class JsonapiDocument{constructor(t){this.data=t||{},this.data.attributes=t.attributes||{},this.data.relationships=t.relationships||{}}addAttributes(t){this.data.attributes=Object.assign(this.data.attributes,t)}removeAttributes(t){t.forEach(t=>{delete this.data.attributes[t]})}addRelationships(t){this.data.relationships=Object.assign(this.data.relationships,t)}removeRelationships(t){t.forEach(t=>{delete this.data.relationships[t]})}getId(){return this.data.id}setId(t){this.data.id=t}}